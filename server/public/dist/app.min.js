var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__async=(e,t,n)=>new Promise((o,a)=>{var i=e=>{try{l(n.next(e))}catch(t){a(t)}},s=e=>{try{l(n.throw(e))}catch(t){a(t)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,s);l((n=n.apply(e,t)).next())});!function(){"use strict";const e=function(e,t,n){let o=Promise.resolve();function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},t=window.location.origin,n=5242880,o=60,a=60,i={instagram:{baseUrl:"https://instagram.com/",domains:["instagram.com"],handlePattern:/^@?[\w](?!.*?\.{2})[\w.]{0,28}[\w]$/},facebook:{baseUrl:"https://facebook.com/",domains:["facebook.com","fb.com"],handlePattern:/^@?[a-zA-Z0-9.]{3,}$/},twitter:{baseUrl:"https://twitter.com/",domains:["twitter.com","x.com"],handlePattern:/^@?[a-zA-Z0-9_]{1,15}$/},linkedin:{baseUrl:"https://linkedin.com/in/",domains:["linkedin.com"],handlePattern:/^[a-zA-Z0-9-]{3,100}$/},youtube:{baseUrl:"https://youtube.com/@",domains:["youtube.com","youtu.be"],handlePattern:/^@?[a-zA-Z0-9_-]{3,30}$/},tiktok:{baseUrl:"https://tiktok.com/@",domains:["tiktok.com"],handlePattern:/^@?[a-zA-Z0-9_.]{2,24}$/},snapchat:{baseUrl:"https://snapchat.com/add/",domains:["snapchat.com"],handlePattern:/^[a-zA-Z][a-zA-Z0-9._-]{1,15}$/},whatsapp:{baseUrl:"https://wa.me/",domains:["wa.me","whatsapp.com"],handlePattern:/^\+?[1-9]\d{1,14}$/},calendly:{baseUrl:"https://calendly.com/",domains:["calendly.com"],handlePattern:/^[a-zA-Z0-9-_]{3,30}$/},telegram:{baseUrl:"https://t.me/",domains:["t.me","telegram.com","telegram.me"],handlePattern:/^@?[a-zA-Z0-9_]{5,32}$/},reddit:{baseUrl:"https://reddit.com/u/",domains:["reddit.com"],handlePattern:/^(u\/)?[a-zA-Z0-9_-]{3,20}$/},pinterest:{baseUrl:"https://pinterest.com/",domains:["pinterest.com"],handlePattern:/^[a-zA-Z0-9_]{3,30}$/},zoom:{baseUrl:"",domains:["zoom.us","zoom.com"],handlePattern:null}},s=["com","org","net","edu","gov","co","io","ai","app","dev","uk","us","ca","au","de","fr","in","me","info","biz","ly","it","es","ru","jp","cn","br","mx","id","ph","vn","tv","cc","ws","mobi","online","site","tech","store","xyz"],l={instagram:'<i class="fab fa-instagram"></i>',facebook:'<i class="fab fa-facebook"></i>',twitter:'<i class="fab fa-twitter"></i>',linkedin:'<i class="fab fa-linkedin"></i>',calendly:'<i class="fas fa-calendar-alt"></i>',snapchat:'<i class="fab fa-snapchat"></i>',tiktok:'<i class="fab fa-tiktok"></i>',youtube:'<i class="fab fa-youtube"></i>',whatsapp:'<i class="fab fa-whatsapp"></i>',zoom:'<i class="fas fa-headphones"></i>',reddit:'<i class="fa-brands fa-reddit"></i>',telegram:'<i class="fa-brands fa-telegram"></i>',pinterest:'<i class="fa-brands fa-pinterest"></i>'},r=["instagram","facebook","twitter","linkedin","calendly","zoom","snapchat","tiktok","youtube","whatsapp","telegram","reddit","pinterest"];!function(){__async(this,null,function*(){yield function(){return __async(this,null,function*(){try{const e=yield fetch("/api/card/get-client-ip"),t=yield e.json();return t.success?t.ip:null}catch(e){return null}})}()})}();const c=new class{constructor(e=t){this.baseURL=e,this.token=this.getToken()}getToken(){return localStorage.getItem("authToken")||null}setToken(e){this.token=e,localStorage.setItem("authToken",e)}clearToken(){this.token=null,localStorage.removeItem("authToken")}apiRequest(e){return __async(this,arguments,function*(e,t={}){const n=`${this.baseURL}${e}`,o=__spreadValues({headers:__spreadValues({"Content-Type":"application/json"},t.headers),credentials:"include"},t);try{const e=yield fetch(n,o),t=yield e.json();if(!e.ok)throw new Error(t.message||"API request failed");return t}catch(a){throw a}})}checkAuthStatus(){return __async(this,null,function*(){try{return(yield this.apiRequest("/auth/status")).authenticated}catch(e){return!1}})}getCurrentUser(){return __async(this,null,function*(){return this.apiRequest("/auth/me")})}logout(){return __async(this,null,function*(){try{return yield this.apiRequest("/auth/logout",{method:"POST"}),this.clearToken(),!0}catch(e){return this.clearToken(),!1}})}getProfile(){return __async(this,null,function*(){try{return yield this.apiRequest("/api/profile")}catch(e){return{success:!1,error:e.message}}})}saveProfile(e){return __async(this,null,function*(){return this.apiRequest("/api/profile",{method:"POST",body:JSON.stringify(e)})})}uploadQRCode(e){return __async(this,null,function*(){const t=new FormData;return t.append("qrCode",e),this.apiRequest("/api/profile/upload-qr",{method:"POST",headers:{},body:t})})}updatesuggestions(e){return __async(this,null,function*(){return this.apiRequest("/api/suggestions",{method:"POST",body:JSON.stringify(e)})})}updatecontactinfo(e){return __async(this,null,function*(){return this.apiRequest("/api/contact",{method:"POST",body:JSON.stringify(e)})})}deleteProfile(){return __async(this,null,function*(){return this.apiRequest("/api/profile",{method:"DELETE"})})}getAnalytics(){return __async(this,null,function*(){return this.apiRequest("/api/profile/analytics")})}getPublicCard(e){return __async(this,null,function*(){return this.apiRequest(`/api/card/${e}`)})}downloadVCard(e){return __async(this,null,function*(){const t=`${this.baseURL}/api/card/${e}/vcard`;window.open(t,"_blank")})}downloadWalletPass(e){return __async(this,null,function*(){const t=`${this.baseURL}/api/card/${e}/wallet-pass`;window.open(t,"_blank")})}getQRCode(e,t=400){return __async(this,null,function*(){return`${this.baseURL}/api/card/${e}/qr?size=${t}`})}getstyledQRCode(e,t=400){return __async(this,null,function*(){return`${this.baseURL}/api/card/${e}/download-styled-qr`})}trackSocialClick(e,t){return __async(this,null,function*(){return this.apiRequest(`/api/card/${e}/track/${t}`,{method:"POST"})})}trackContactClick(e,t){return __async(this,null,function*(){return this.apiRequest(`/api/card/${e}/track/contact/${t}`,{method:"POST"})})}searchCards(e,t=10){return __async(this,null,function*(){return this.apiRequest(`/api/card/search/${encodeURIComponent(e)}?limit=${t}`)})}};function d(){return"QRP-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function u(){return"auth-"+Math.random().toString(36).substr(2,15)}function m(e){const t=document.getElementById("email");t&&(t.value=e,t.setAttribute("readonly",!0),t.style.backgroundColor="#f8f9fa",t.style.cursor="not-allowed",t.style.color="#6c757d")}function h(){const e=document.getElementById("wallet-loader");e&&e.remove()}function p(){return __async(this,null,function*(){const t=document.querySelector(".copy-url-btn"),n=$(t).data("personal-card-url");try{navigator.clipboard&&window.isSecureContext?yield navigator.clipboard.writeText(n):(urlInput.select(),document.execCommand("copy"));const o=t.textContent;t.textContent="Copied!",t.style.background="#28a745",setTimeout(()=>{t.textContent=o,t.style.background="#667eea"},2e3);const{showSuccessMessage:a}=yield e(()=>__async(this,null,function*(){const{showSuccessMessage:e}=yield Promise.resolve().then(()=>b);return{showSuccessMessage:e}}));a("Card URL copied to clipboard!")}catch(o){const{showErrorMessage:t}=yield e(()=>__async(this,null,function*(){const{showErrorMessage:e}=yield Promise.resolve().then(()=>b);return{showErrorMessage:e}}));t("Failed to copy URL. Please copy manually.")}})}function y(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        bottom: 2rem;\n        right: 2rem;\n        background: #28a745;\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        z-index: 1001;\n        font-weight: 600;\n        box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);\n        animation: slideInUp 0.3s ease;\n    ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.style.animation="slideOutDown 0.3s ease forwards",setTimeout(()=>t.remove(),300)},3e3)}function g(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        bottom: 2rem;\n        right: 2rem;\n        background: #dc3545;\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        z-index: 1001;\n        font-weight: 600;\n        box-shadow: 0 10px 25px rgba(220, 53, 69, 0.3);\n    ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>t.remove(),4e3)}function f(e,t){const n=document.getElementById(e);n.style.borderColor="#ee8b46",n.style.backgroundColor="#fff5f5";if(["instagram","facebook","twitter","linkedin","calendly","zoom","snapchat","tiktok","youtube","whatsapp","telegram","reddit","pinterest"].includes(e)){const e=n.closest(".social-item").querySelector(".input-error");e&&(e.innerHTML=`\n                <div class="error-message" style="\n                    color: #ee8b46;\n                    font-size: 0.875rem;\n                    margin-top: 0.5rem;\n                    font-weight: 500;\n                    display: block;\n                    width: 100%;\n                ">${t}</div>\n            `)}else{const e=n.closest(".form-group").querySelector(".error-message");e&&e.remove();const o=document.createElement("div");o.className="error-message",o.style.cssText="\n            color: #ee8b46;\n            font-size: 0.875rem;\n            margin-top: 0.5rem;\n            font-weight: 500;\n            display: block;\n            width: 100%;\n        ",o.textContent=t,n.parentNode.insertBefore(o,n.nextSibling)}}function v(){document.querySelectorAll("#profileForm input, #profileForm textarea").forEach(e=>{e.style.borderColor="",e.style.backgroundColor=""});document.querySelectorAll(".input-error").forEach(e=>{e.innerHTML=""});document.querySelectorAll(".error-message").forEach(e=>e.remove())}function w(){const e=document.querySelectorAll(".error-message"),t=document.querySelectorAll(".input-error:not(:empty)");let n=null;if(e.length>0){const t=e[0];n=t.previousElementSibling||t.parentElement.querySelector("input, textarea, select")}if(!n&&t.length>0){const e=t[0].closest(".social-item");n=e?e.querySelector("input"):null}n&&(n.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{n.focus(),n.style.animation="shake 0.5s",setTimeout(()=>{n.style.animation=""},500)},300))}const b=Object.freeze(Object.defineProperty({__proto__:null,clearAllErrors:v,scrollToFirstError:w,showError:f,showErrorMessage:g,showSuccessMessage:y},Symbol.toStringTag,{value:"Module"}));function E(){return __async(this,null,function*(){const e=z();if(e)try{const t=document.getElementById("socialLinksDisplay");if(t.innerHTML="",document.getElementById("displayName").textContent=e.name,document.getElementById("displayTitle").textContent=e.title,document.getElementById("displayOrganization").textContent=e.organization,document.getElementById("displayEmail").textContent=e.email,document.getElementById("displayAddress").textContent=e.address,e.mobile?($("#displayPhoneLink").attr("href",`tel:${e.mobile}`).show(),$("#displayMessageLink").attr("href",`sms:${e.mobile}`).show(),document.getElementById("displayPhoneLink").querySelector(".method-value").textContent=e.mobile,document.getElementById("displayMessageLink").querySelector(".method-value").textContent=e.mobile):($("#displayPhoneLink").hide(),$("#displayMessageLink").hide()),document.getElementById("displayEmailLink").href=`mailto:${e.email}`,document.getElementById("displayEmail").textContent=e.email,document.getElementById("displayWebsite").href=e.website,document.getElementById("displayWebsite").querySelector(".method-value").textContent=e.website.replace("https://","").replace("http://",""),r.forEach(n=>{let o=e.socialMedia&&e.socialMedia[n];if(o&&"string"==typeof o&&o.trim()&&""!==o.trim()){const e=document.createElement("div");e.className="contact-detail",o.startsWith("http://")||o.startsWith("https://")||(o="https://"+o),e.innerHTML=`\n                    <span>${l[n]||'<i class="fas fa-link"></i>'}</span>\n                    <a href="${o}" target="_blank" class="contact-link" onclick="trackSocialClick('${n}')">\n                        ${n.charAt(0).toUpperCase()+n.slice(1)}\n                    </a>\n                `,t.appendChild(e)}}),e.cardId){const t=e.slug||e.cardId,n=`${window.location.origin}/card/${t}`,o=yield c.getQRCode(t);document.getElementById("generatedQR").innerHTML=`\n                <div class="profile-qrcode-div">\n                    <div class="profile-qrcode-image-div">\n                        <img src="${o}" alt="QR Code" class="qr-preview" style="border-radius: 10px;">\n                        <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Scan to view card</p>\n                    </div>\n                    <div class="Download-qrcode-buttons">\n                        <button class="profile-card-buttons" id="downloadVCard-btn-dynamic">\n                            <i class="fas fa-download"></i>\n                            Save Contact\n                        </button>\n                        <button class="profile-card-buttons" id="downloadQRCode-btn-dynamic">\n                            <i class="fas fa-qrcode"></i>\n                            Download QR Code\n                        </button>\n                        <button class="profile-card-buttons hidden" id="addToWallet-btn">\n                            <i class="fas fa-mobile-alt"></i>\n                            Add to Wallet\n                        </button>\n                    </div>\n                </div>\n                \n                <div class="standalone-url-section" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">\n                    <h4 style="font-size: 0.9rem; color: #333; margin-bottom: 0.5rem;">🔗 Share Your Card</h4>\n                    <div class="url-container" style="display: flex; align-items: center; gap: 0.5rem;">\n                        <p style="font-size: 0.75rem; color: #666; margin-top: 0.5rem; margin-bottom: 0;">\n                            ${n?`Your personalized URL: ${n}`:"Share this link or QR code with others"}\n                        </p>\n                        <button data-personal-card-url="${n}" class="copy-url-btn" \n                                style="padding: 0.5rem 1rem; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8rem; white-space: nowrap; width: 100%;">\n                            📋 Copy\n                        </button>\n                    </div>\n                </div>\n            `}$("#navbarAvatar").show(),$("#navbarAvatarDesktop").show(),$(".card-actions").appendTo("#Download-qrcode-buttons"),C()}catch(t){}})}function C(){const e=z();if(!e)return;document.getElementById("standaloneName").textContent=e.name,document.getElementById("standaloneTitle").textContent=e.title,document.getElementById("standaloneOrganization").textContent=e.organization,document.getElementById("standaloneEmail").textContent=e.email,document.getElementById("standaloneAddress").textContent=e.address,document.getElementById("standalonePhone").href=`tel:${e.phone}`,document.getElementById("standalonePhone").querySelector("span:last-child").textContent=e.phone,document.getElementById("standaloneMessage").href=`sms:${e.mobile}`,document.getElementById("standaloneWebsiteLink").href=e.website,document.getElementById("standaloneWebsite").textContent=e.website.replace("https://","").replace("http://","");const t=document.getElementById("standaloneSocialLinks");t.innerHTML="";const n={instagram:"📷",facebook:"📘",twitter:"🦆",calendly:"📅",zoom:"💼",snapchat:"👻",tiktok:"🎵",linkedin:"💼"};Object.keys(e.socialMedia||{}).forEach(o=>{const a=e.socialMedia[o];if(a){const e=document.createElement("a");e.className="standalone-social-item",e.href=a,e.target="_blank",e.innerHTML=`\n                <span class="social-icon">${n[o]}</span>\n                <span>${o}</span>\n            `,t.appendChild(e)}})}function k(){return __async(this,null,function*(){try{const e=z();e&&e.cardId&&(yield c.downloadVCard(e.cardId),y("vCard download started!"))}catch(e){g("Failed to download vCard")}})}function I(){return __async(this,null,function*(){try{const e=z();if(e&&(e.slug||e.cardId)){const t=e.slug||e.cardId,n=yield c.getstyledQRCode(t),o=yield fetch(n);if(!o.ok)throw new Error("Download failed");const a=yield o.blob(),i=window.URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`${e.name.replace(/\s+/g,"-")}-QR-Card.png`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i),y("Styled QR Card downloaded!")}}catch(e){g("Failed to download styled QR card")}})}const B=Object.freeze(Object.defineProperty({__proto__:null,downloadQRCode:function(){return __async(this,null,function*(){try{const e=z();if(e&&e.cardId){const t=e.slug||e.cardId,n=yield c.getQRCode(t),o=document.createElement("a");o.href=n,o.download=`${e.name}-QRCode.png`,document.body.appendChild(o),o.click(),document.body.removeChild(o),y("QR Code downloaded!")}}catch(e){g("Failed to download QR code")}})},downloadStyledQRCard:I,downloadVCard:k,loadStandaloneCard:function(){return __async(this,null,function*(){const e=new URLSearchParams(window.location.search).get("card");if(e)try{const t=yield c.getPublicCard(e);if(t.success)return function(e){document.getElementById("standaloneName").textContent=e.name,document.getElementById("standaloneTitle").textContent=e.title,document.getElementById("standaloneOrganization").textContent=e.organization,document.getElementById("standaloneEmail").textContent=e.email,document.getElementById("standaloneAddress").textContent=e.address,document.getElementById("standalonePhone").href=`tel:${e.phone}`,document.getElementById("standalonePhone").querySelector("span:last-child").textContent=e.phone,document.getElementById("standaloneMessage").href=`sms:${e.mobile}`,document.getElementById("standaloneWebsiteLink").href=e.website,document.getElementById("standaloneWebsite").textContent=e.website.replace("https://","").replace("http://","");const t=document.getElementById("standaloneSocialLinks");t.innerHTML="";const n={instagram:"📷",facebook:"📘",twitter:"🦆",linkedin:"💼",calendly:"📅",zoom:"💼",snapchat:"👻",tiktok:"🎵"};Object.keys(e.socialMedia||{}).forEach(o=>{const a=e.socialMedia[o];if(a){const i=document.createElement("a");i.className="standalone-social-item",i.href=a,i.target="_blank",i.onclick=()=>c.trackSocialClick(e.cardId,o),i.innerHTML=`\n                <span class="social-icon">${n[o]}</span>\n                <span>${o}</span>\n            `,t.appendChild(i)}}),window.currentCardData=e}(t.card),!0}catch(t){document.getElementById("standalonePage").innerHTML='\n                <div style="text-align: center; padding: 3rem;">\n                    <h2>Card Not Found</h2>\n                    <p>The requested business card could not be found or is not public.</p>\n                    <button onclick="window.location.href=\'/\'" class="standalone-btn">Go Home</button>\n                </div>\n            '}return!1})},trackContactClick:function(e){return __async(this,null,function*(){const t=z();t&&t.cardId&&(yield c.trackContactClick(t.cardId,e))})},trackSocialClick:function(e){return __async(this,null,function*(){const t=z();t&&t.cardId&&(yield c.trackSocialClick(t.cardId,e))})},updateDisplayPage:E,updateStandalonePage:C},Symbol.toStringTag,{value:"Module"}));function _(){return __async(this,null,function*(){if(confirm("Are you sure you want to remove your profile photo?"))try{(yield $.ajax({url:"/api/profile/delete-profile-photo",method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("token")}})).success&&(y("Profile photo removed successfully!"),$("#profilePhotoImg").hide(),$("#avatarDisplay").show(),$("#deletePhotoBtn").hide(),$("#profilePhotoInput").val(""),yield S())}catch(e){g("Error removing photo")}})}function L(){$("#uploadPhotoBtn").on("click",function(){$("#profilePhotoInput").click()}),$("#profilePhotoInput").on("change",function(e){return __async(this,null,function*(){const t=e.target.files[0];if(!t)return;if(t.size>n)return g("File size must be less than 5MB"),void $(this).val("");const o=t.name.toLowerCase(),a=o.endsWith(".heic")||o.endsWith(".heif");if(!t.type.startsWith("image/")&&!a)return g("Please select an image file (JPG, PNG, GIF, HEIC)"),void $(this).val("");if(a)$("#avatarDisplay").show(),$("#profilePhotoImg").hide();else{const e=new FileReader;e.onload=function(e){$("#profilePhotoImg").attr("src",e.target.result).show(),$("#avatarDisplay").hide()},e.readAsDataURL(t)}yield function(e){return __async(this,null,function*(){var t;const n=new FormData;n.append("profilePhoto",e);const o=e.name.toLowerCase().endsWith(".heic")||e.name.toLowerCase().endsWith(".heif"),a=$("#uploadPhotoBtn"),i=a.html();a.prop("disabled",!0).text(o?"Converting & Uploading...":"Uploading...");try{(yield $.ajax({url:"/api/profile/upload-profile-photo",method:"POST",data:n,processData:!1,contentType:!1,headers:{Authorization:"Bearer "+localStorage.getItem("token")}})).success&&(y("Profile photo uploaded successfully!"),$("#deletePhotoBtn").show(),a.prop("disabled",!1).html(i),yield S())}catch(s){g((null==(t=s.responseJSON)?void 0:t.message)||"Error uploading photo"),$("#profilePhotoImg").hide(),$("#avatarDisplay").show(),$("#profilePhotoInput").val(""),a.prop("disabled",!1).html(i)}})}(t)})}),$("#deletePhotoBtn").on("click",_)}function x(){return __async(this,null,function*(){var e,t,n,o,a,i,s,l;try{!function(e){const t=document.getElementById("loadingMessage");t&&t.remove();const n=document.createElement("div");n.id="loadingMessage",n.style.cssText="\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        background: rgba(102, 126, 234, 0.95);\n        color: white;\n        padding: 2rem 3rem;\n        border-radius: 15px;\n        z-index: 2000;\n        font-weight: 600;\n        text-align: center;\n        backdrop-filter: blur(10px);\n        box-shadow: 0 20px 40px rgba(0,0,0,0.3);\n    ",n.innerHTML=`\n        <div style="margin-bottom: 1rem;">⏳</div>\n        <div>${e}</div>\n    `,document.body.appendChild(n)}("Saving profile and generating QR codes...");const r=document.getElementById("profileForm");if(!r)throw new Error("Profile form not found");const d={};["instagram","facebook","twitter","linkedin","calendly","zoom","snapchat","tiktok","youtube","whatsapp","telegram","reddit","pinterest"].forEach(e=>{const t=document.getElementById(e);if(t){const n=t.getAttribute("data-final-url");n&&n.trim()&&(d[e]=n)}});const u=new FormData(r),m=window.locationAutocomplete?window.locationAutocomplete.getSelectedLocation():null,h={name:u.get("name"),title:u.get("title"),organization:u.get("organization"),phone:u.get("phone"),mobile:u.get("mobile"),email:u.get("email"),website:u.get("website"),address:u.get("address"),notes:u.get("notes"),showPhoneNumber:$("#showPhoneNumber").is(":checked"),country:{name:(null==(e=null==m?void 0:m.country)?void 0:e.name)||u.get("country")||"",code:u.get("countryCode")||(null==(t=null==m?void 0:m.country)?void 0:t.code)||""},state:{name:(null==(n=null==m?void 0:m.state)?void 0:n.name)||u.get("state")||"",id:u.get("stateId")||(null==(o=null==m?void 0:m.state)?void 0:o.id)||"",code:u.get("stateCode")||(null==(a=null==m?void 0:m.state)?void 0:a.code)||""},city:{name:(null==(i=null==m?void 0:m.city)?void 0:i.name)||u.get("city")||"",id:u.get("cityId")||(null==(s=null==m?void 0:m.city)?void 0:s.id)||""},socialMedia:d,isPublic:$("#isPublic").is(":checked")},p=yield c.saveProfile(h);if(!p.success)throw new Error(p.message||"Save failed");{D(p.profile);let e="Profile saved successfully!";p.qrGenerated&&(e+=` Generated ${(null==(l=p.qrCodes)?void 0:l.length)||0} QR codes.`),y(e),E(),$(".profile-photo-section").show(),setTimeout(()=>{P("display")},1500)}}catch(r){g("Failed to save profile: "+r.message)}finally{!function(){const e=document.getElementById("loadingMessage");e&&e.remove()}()}})}function S(){return __async(this,null,function*(){var e,t,n;try{const o=yield c.getProfile();if(o.success&&o.profile){const a=o.profile;D(a),document.getElementById("email").value=o.profile.email,void 0!==a.showPhoneNumber&&(document.getElementById("showPhoneNumber").checked=a.showPhoneNumber);const i=document.getElementById("profileForm");if(i){i.querySelectorAll("input, textarea").forEach(e=>{const t=e.name;"country"!==t&&"state"!==t&&"city"!==t&&(t&&void 0!==a[t]?e.value=a[t]:t&&a.socialMedia&&void 0!==a.socialMedia[t]&&(e.value=a.socialMedia[t]))})}if((null==(e=a.country)?void 0:e.name)&&(document.getElementById("country").value=a.country.name,document.getElementById("countryCode").value=a.country.code||"",window.locationAutocomplete)){const e=window.locationAutocomplete.countries.find(e=>e.code===a.country.code);e&&window.locationAutocomplete.selectCountry(e)}if((null==(t=a.state)?void 0:t.name)&&setTimeout(()=>{if(document.getElementById("state").value=a.state.name,document.getElementById("stateId").value=a.state.id||"",document.getElementById("stateCode").value=a.state.code||"",window.locationAutocomplete&&window.locationAutocomplete.selectedCountry){const e=window.locationAutocomplete.currentStates.find(e=>e.id===a.state.id);e&&window.locationAutocomplete.selectState(e)}},500),(null==(n=a.city)?void 0:n.name)&&setTimeout(()=>{document.getElementById("city").value=a.city.name,document.getElementById("cityId").value=a.city.id||""},1e3),a.uploadedQR&&a.uploadedQR.url){const e=document.getElementById("qrPreview"),t=document.getElementById("qrUploadText");e&&t&&(e.src=c.baseURL+a.uploadedQR.url,e.classList.remove("hidden"),t.innerHTML="QR Code uploaded ✅<br><small>Click to change</small>")}!function(e){const t=$("#avatarDisplay"),n=$("#avatarInitials"),o=$("#profilePhotoImg"),a=$("#deletePhotoBtn");e.hasProfilePhoto?(o.attr("src",`/api/profile/photo/${e._id}`),o.show(),t.hide(),a.show()):(n.text(e.initials),t.show(),o.hide(),a.hide())}(a),function(e){let t=$(".navbar-avatar");0===t.length&&(t=$('<div class="navbar-avatar"></div>'),$("#logoutBtn").after(t)),t.empty(),e.hasProfilePhoto?t.html(`<img src="/api/profile/photo/${e._id}" alt="Profile">`):t.text(e.initials),t.off("click").on("click",function(){})}(a)}else if(o.success&&!o.profile){D(null);const e=yield c.getCurrentUser();1==e.success&&(document.getElementById("email").value=e.user.email)}else P("login")}catch(o){o.message.includes("retrieving profile")?g("Unable to load your profile. Please try refreshing the page."):g("Profile loading error: "+o.message)}})}function P(e){return __async(this,null,function*(){const t=U();if(yield T())return;if(!t&&("profile"===e||"display"===e||"wallet"===e))return P("home"),void g("Please log in to access Profile and Card page");document.querySelectorAll(".page").forEach(e=>{e.classList.remove("active"),e.style.display="none"});const n=document.getElementById(e+"Page");n&&(n.classList.add("active"),n.style.display="block","profile"===e?S():"display"===e?E():"wallet"===e&&"function"==typeof loadWalletCards&&loadWalletCards())})}function T(){return __async(this,null,function*(){if(new URLSearchParams(window.location.search).get("card")){document.querySelector(".navbar").style.display="none",document.getElementById("standalonePage").style.display="flex",document.querySelectorAll(".page:not(#standalonePage)").forEach(e=>{e.style.display="none"});const{loadStandaloneCard:t}=yield e(()=>__async(this,null,function*(){const{loadStandaloneCard:e}=yield Promise.resolve().then(()=>B);return{loadStandaloneCard:e}}));return yield t()}return!1})}function q(){return __async(this,null,function*(){const t=new URLSearchParams(window.location.search);if(!t.toString())return P("display"),null;const n={};for(const[e,o]of t.entries())n[e]=o;if(t.has("page")){const{getUserStatus:o}=yield e(()=>__async(this,null,function*(){const{getUserStatus:e}=yield Promise.resolve().then(()=>H);return{getUserStatus:e}})),a=t.get("page"),i={home:"home",faq:"faq",usecase:"usecase",scenario:"usecase"};if(i[a])return P(i[a]),n;if(["signup","login","profile","wallet"].includes(a)){const e=yield o();e&&e.authenticated?P("signup"===a||"login"===a?"display":a):P("profile"===a||"wallet"===a?"login":a)}}return n})}let M=null,A=null;function R(e){M=e}function D(e){A=e}function U(){return M}function z(){return A}function W(){return __async(this,null,function*(){window.location.href=`${c.baseURL}/auth/google`})}function N(){return __async(this,null,function*(){window.location.href=`${c.baseURL}/auth/google`})}function O(){return __async(this,null,function*(){try{(yield c.logout())&&($("#navbarAvatar").css("display","none"),$("#navbarAvatarDesktop").css("display","none"),M=null,A=null,j(),F(),P("home"),y("Successfully logged out!"),$("#footer-cta").removeClass("display-none-cta-button"),$("#footer-cta").addClass("cta-section"),$("#singup-cta-button-div-uc").removeClass("display-none-cta-button"),$("#singup-cta-button-div-uc").addClass("usecase-cta"))}catch(e){g("Error logging out. Please try again.")}})}function j(){const e=document.getElementById("loginBtn"),t=document.getElementById("signupBtn"),n=document.getElementById("profileBtn"),o=document.getElementById("displayBtn"),a=document.getElementById("walletBtn"),i=document.getElementById("logoutBtn"),s=document.getElementById("faqBtn");null==s||s.classList.remove("hidden"),M?(null==e||e.classList.add("hidden"),null==t||t.classList.add("hidden"),null==n||n.classList.remove("hidden"),null==o||o.classList.remove("hidden"),null==a||a.classList.remove("hidden"),null==i||i.classList.remove("hidden")):(null==e||e.classList.remove("hidden"),null==t||t.classList.remove("hidden"),null==n||n.classList.add("hidden"),null==o||o.classList.add("hidden"),null==a||a.classList.add("hidden"),null==i||i.classList.add("hidden"))}function F(){const e=document.getElementById("loginBtnMobile"),t=document.getElementById("signupBtnMobile"),n=document.getElementById("profileBtnMobile"),o=document.getElementById("displayBtnMobile"),a=document.getElementById("walletBtnMobile"),i=document.getElementById("logoutBtnMobile"),s=document.getElementById("faqBtnMobile");null==s||s.classList.remove("hidden"),M?(null==e||e.classList.add("hidden"),null==t||t.classList.add("hidden"),null==n||n.classList.remove("hidden"),null==o||o.classList.remove("hidden"),null==a||a.classList.remove("hidden"),null==i||i.classList.remove("hidden")):(null==e||e.classList.remove("hidden"),null==t||t.classList.remove("hidden"),null==n||n.classList.add("hidden"),null==o||o.classList.add("hidden"),null==a||a.classList.add("hidden"),null==i||i.classList.add("hidden"))}const H=Object.freeze(Object.defineProperty({__proto__:null,get currentUser(){return M},getCurrentUser:U,getUserProfile:z,getUserStatus:function(){return __async(this,null,function*(){try{return yield $.ajax({url:"auth/status",method:"GET",dataType:"json"})}catch(e){}})},loginWithGoogle:W,logout:O,setCurrentUser:R,setUserProfile:D,signupWithGoogle:N,updateAuthUI:j,updateAuthUImobilebuttons:F,get userProfile(){return A}},Symbol.toStringTag,{value:"Module"}));function Q(){return/Android/i.test(navigator.userAgent)}function G(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}function V(){return!(G()||/iPad/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1||Q()||/webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))}function Z(){var e,t,n,o;if(!z())return;const a={name:document.getElementById("displayName").textContent||"John Doe",phone:(null==(t=null==(e=document.getElementById("displayPhoneLink"))?void 0:e.querySelector(".method-value"))?void 0:t.textContent)||"",email:document.getElementById("displayEmail").textContent||"",website:(null==(o=null==(n=document.getElementById("displayWebsite"))?void 0:n.querySelector(".method-value"))?void 0:o.textContent)||"",qrCodeData:window.location.href};G()?function(e){__async(this,null,function*(){!function(e){d(),u(),e.name,e.phone,e.email,e.website&&e.website,e.qrCodeData}(e);const t=z();"https:"===window.location.protocol&&t?function(e,t,n){__async(this,null,function*(){!function(){const e=document.createElement("div");e.id="wallet-loader",e.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n        color: white;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    ",e.innerHTML='\n        <div style="text-align: center;">\n            <div style="width: 40px; height: 40px; border: 3px solid #667eea; border-top: 3px solid transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>\n            <p>Generating wallet pass...</p>\n        </div>\n        <style>\n            @keyframes spin {\n                0% { transform: rotate(0deg); }\n                100% { transform: rotate(360deg); }\n            }\n        </style>\n    ',document.body.appendChild(e)}();const e=`/api/card/${z().slug}/apple-wallet-pass`;try{const o=yield fetch(e,{method:"GET",headers:{Accept:"application/vnd.apple.pkpass, application/octet-stream"}});if(h(),!o.ok)throw new Error(`Failed to generate ${n} wallet pass`);const a=window.location.origin+e;if("apple"===n&&G())return;if("google"===n&&Q());else{const e=document.createElement("a");e.href=a,e.download=`${t.name.replace(/\s+/g,"_")}.${"apple"===n?"pkpass":"gwpass"}`,e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}catch(o){h(),J()}})}(0,e,"apple"):J()})}(a):Q()?generateGoogleWalletPass(a):V()?downloadJSONAndShowPreview(a):function(e){const t=`\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Digital Business Card - ${e.name}</title>\n        <style>\n            body {\n                margin: 0;\n                padding: 20px;\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n                background: #f0f0f0;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n                min-height: 100vh;\n            }\n            .wallet-pass {\n                width: 340px;\n                max-width: 90vw;\n                height: 220px;\n                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                border-radius: 15px;\n                color: white;\n                padding: 20px;\n                box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n            }\n            .pass-content h1 {\n                font-size: 20px;\n                margin: 0 0 10px 0;\n            }\n            .pass-content p {\n                margin: 3px 0;\n                font-size: 14px;\n            }\n        </style>\n    </head>\n    <body>\n        <div class="wallet-pass">\n            <div class="pass-content">\n                <h1>${e.name}</h1>\n                <p>${e.phone}</p>\n                <p>${e.email}</p>\n                ${e.website?`<p>${e.website}</p>`:""}\n            </div>\n        </div>\n    </body>\n    </html>`,n=window.open();n.document.write(t),n.document.close()}(a)}function J(e){!function(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n    ";const n=document.createElement("div");n.style.cssText="\n        background: white;\n        padding: 30px;\n        border-radius: 20px;\n        max-width: 500px;\n        text-align: center;\n    ",n.innerHTML=e+'\n        <button id="closeModalBtn" \n                style="background: #667eea; color: white; border: none; padding: 10px 20px; \n                       border-radius: 10px; cursor: pointer; font-size: 16px; margin-top: 20px;">\n            Got it!\n        </button>\n    ',t.appendChild(n),document.body.appendChild(t),document.getElementById("closeModalBtn").addEventListener("click",function(){t.remove()})}('\n        <h2>Add to Apple Wallet</h2>\n        <p>To add this business card to your Apple Wallet:</p>\n        <ol style="text-align: left; margin: 20px 0;">\n            <li>A wallet pass file will be generated</li>\n            <li>Tap "Add" when prompted</li>\n            <li>The card will appear in your Wallet app</li>\n        </ol>\n    ')}function K(e){return e.trim().replace(/^@+/,"")}function Y(e,t){const n=K(t),o=i[e];if(!o)return t;if("whatsapp"===e){const e=n.replace(/[^\d+]/g,"");return`${o.baseUrl}${e}`}return"reddit"!==e||n.startsWith("u/"),`${o.baseUrl}${n}`}function X(e,t){if(!t||""===t.trim())return{valid:!0,url:""};const n=t.trim(),o=i[e];if(!o)return{valid:!0,url:n};const a=function(e){if(e.startsWith("http://")||e.startsWith("https://"))return!0;if(e.includes("/"))return!0;if(e.includes(".")){const t=e.split(".");if(t.length>2)return!0;if(2===t.length){const e=t[1].toLowerCase().split("/")[0];return!!s.includes(e)}}return!1}(n);if(!a){if(o.handlePattern){const t=K(n);if(o.handlePattern.test(t)){return{valid:!0,url:Y(e,n)}}return{valid:!1,url:"",error:`Please enter a valid ${e} handle`}}return{valid:!0,url:Y(e,n)}}try{let t=n;t.startsWith("http://")||t.startsWith("https://")||(t="https://"+t);const a=new URL(t);return o.domains.some(e=>a.hostname.includes(e))?{valid:!0,url:t}:{valid:!1,url:"",error:`Please enter a valid ${e} URL or handle`}}catch(l){if(o.handlePattern){const t=K(n);if(o.handlePattern.test(t)){return{valid:!0,url:Y(e,n)}}return{valid:!1,url:"",error:`Please enter a valid ${e} handle or URL`}}return{valid:!0,url:Y(e,n)}}}function ee(e,t){const n=document.getElementById(e);if(!n)return!0;const o=n.value.trim();if(!o)return!0;if("website"===e)try{let e=o;return e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),new URL(e),n.setAttribute("data-final-url",e),!0}catch(i){return f(e,t),!1}const a=X(e,o);return a.valid?(n.setAttribute("data-final-url",a.url),!0):(f(e,a.error||t),!1)}function te(e){return/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)}function ne(e,t,n){const o=document.getElementById(e).value.trim();if(o.length>t){const{showError:a}=require("./form-errors.js");return a(e,`${n} cannot be more than ${t} characters (current: ${o.length})`),!1}return!0}function oe(){const e=document.getElementById("name"),t=document.getElementById("organization"),n=e.value.trim().toLowerCase(),o=t.value.trim().toLowerCase();if(n&&o&&n===o){const{showError:e}=require("./form-errors.js");return e("organization","Organization name cannot be the same as your name"),!1}return!0}function ae(e,t){if(!document.getElementById(e).value.trim()){const{showError:n}=require("./form-errors.js");return n(e,t),!1}return!0}function ie(e){const t=document.getElementById(e).value.trim();if(!t)return!0;if(!/^\d{10}$/.test(t)){const{showError:t}=require("./form-errors.js");return t(e,"Please enter exactly 10 digits"),!1}return!0}function se(){v();let e=!0;e=ae("name","Full name is required")&&e,e=ae("email","Email address is required")&&e;const t=document.getElementById("name").value.trim();t&&(e=ne("name",o,"Name")&&e);const n=document.getElementById("organization").value.trim();n&&(e=ne("organization",a,"Organization")&&e),t&&n&&(e=oe()&&e);const i=document.getElementById("phone").value.trim(),s=document.getElementById("mobile").value.trim();i&&(e=ie("phone")&&e),s&&(e=ie("mobile")&&e);return document.getElementById("website").value.trim()&&(e=ee("website","Please enter a valid website URL")&&e),r.forEach(t=>{document.getElementById(t).value.trim()&&(e=ee(t,`Please enter a valid ${t} URL`)&&e)}),e}function le(){const e=document.getElementById("profileForm");e&&(e.addEventListener("input",function(e){setTimeout(()=>{se()},100)}),e.addEventListener("blur",function(e){const t=e.target.id;if(t){if(r.includes(t)){const t=e.target.closest(".social-item"),n=null==t?void 0:t.querySelector(".input-error");n&&(n.innerHTML="")}else{const t=e.target.parentNode.querySelector(".error-message");t&&t.remove()}e.target.style.borderColor="",e.target.style.backgroundColor="",function(e,t){let n=!0;switch(e){case"name":if(n=ae(e,"Full name is required"),n&&t&&(n=ne("name",o,"Name")),n&&t){document.getElementById("organization").value.trim()&&(n=oe())}break;case"organization":if(t&&(n=ne("organization",a,"Organization")),n&&t){document.getElementById("name").value.trim()&&(n=oe())}break;case"email":n=ae(e,"Email is required");break;case"phone":case"mobile":t&&(n=ie(e));break;case"website":t&&(n=ee("website","Please enter a valid website URL"));break;default:r.includes(e)&&t&&(n=ee(e,`Please enter a valid ${e} URL`))}}(t,e.target.value.trim()),setTimeout(()=>{se()},50)}},!0))}const re={privacy:"privacy-modal",terms:"terms-modal",faq:"faq-modal",suggestions:"suggestions-modal",contact:"contact-modal"},ce={privacy:"privacy-link",terms:"terms-link",faq:"faq-link",suggestions:"suggestions-link",contact:"contact-link"};function de(){Object.entries(ce).forEach(([e,t])=>{const n=document.getElementById(t);n&&n.addEventListener("click",t=>{t.preventDefault(),function(e){const t=re[e],n=document.getElementById(t);n&&(n.style.display="block",document.body.style.overflow="hidden")}(e)})})}function ue(){document.querySelectorAll(".close").forEach(e=>{e&&e.addEventListener("click",()=>{Object.values(re).forEach(e=>{const t=document.getElementById(e);t&&"block"===t.style.display&&(t.style.display="none")}),document.body.style.overflow="auto"})}),Object.values(re).forEach(e=>{const t=document.getElementById(e);t&&t.addEventListener("click",e=>{e.target===t&&(t.style.display="none",document.body.style.overflow="auto")})})}function me(){de(),ue(),document.querySelectorAll(".faq-question").forEach(e=>{e&&e.addEventListener("click",()=>{const t=e.nextElementSibling;if(t){const e=t.classList.contains("show");document.querySelectorAll(".faq-answer").forEach(e=>{e.classList.remove("show")}),e||t.classList.add("show")}})})}function he(e){return __async(this,null,function*(){e.preventDefault();const t=document.getElementById("contact-success");t&&(t.style.display="none");const n=new FormData(e.target),o={name:n.get("name"),email:n.get("email"),category:n.get("category"),title:n.get("title"),details:n.get("details")},a=e.target.querySelector('button[type="submit"]'),i=a.innerHTML,s=function(e){const t=[];return(!e.name||e.name.trim().length<2)&&t.push({field:"suggestion-name",message:"Name must be at least 2 characters"}),e.email&&te(e.email)||t.push({field:"suggestion-email",message:"Please enter a valid email address"}),(!e.title||e.title.trim().length<5)&&t.push({field:"suggestion-title",message:"Title must be at least 5 characters"}),(!e.details||e.details.trim().length<20)&&t.push({field:"suggestion-details",message:"Details must be at least 20 characters"}),t}(o);if(s.length>0)return l=s,document.querySelectorAll(".form-error").forEach(e=>e.remove()),void l.forEach(e=>{const t=document.getElementById(e.field);if(t){const n=document.createElement("div");n.className="form-error",n.style.cssText="\n                color: #dc3545;\n                font-size: 0.875rem;\n                margin-top: 0.25rem;\n            ",n.textContent=e.message,t.parentNode.insertBefore(n,t.nextSibling),t.style.borderColor="#dc3545"}});var l;a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Submitting...',a.disabled=!0;try{const t=yield c.updatesuggestions(o);if(!t||!t.success)throw new Error(t.message||"Failed to submit suggestion");{y(t.message),e.target.reset();const n=e.target.closest(".modal");n&&(n.style.display="none",document.body.style.overflow="auto")}}catch(r){let e="There was an error submitting your suggestion. ";r.message.includes("fetch")||r.message.includes("NetworkError")?e+="Please check your internet connection and try again.":r.message.includes("similar suggestion")?e="A similar suggestion was already submitted recently. Please try a different suggestion.":e+=r.message||"Please try again later.",g(e)}finally{a.innerHTML=i,a.disabled=!1}})}function pe(e){return __async(this,null,function*(){e.preventDefault();const t=document.getElementById("contact-success");t&&(t.style.display="none");const n=new FormData(e.target),o={name:n.get("name"),email:n.get("email"),phone:n.get("phone"),subject:n.get("subject"),message:n.get("message")},a=e.target.querySelector('button[type="submit"]'),i=a.innerHTML,s=!(l=o).name||l.name.trim().length<2?"Please enter a valid name (at least 2 characters)":l.email&&te(l.email)?l.subject?!l.message||l.message.trim().length<10?"Please enter a message (at least 10 characters)":l.phone&&l.phone.trim()&&(r=l.phone,!/^[\+]?[1-9][\d]{0,15}$/.test(r.trim()))?"Please enter a valid phone number or leave it empty":null:"Please select a subject":"Please enter a valid email address";var l,r;if(s)g(s);else{a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Sending...',a.disabled=!0;try{const n=yield c.updatecontactinfo(o);if(!n||!n.success)throw new Error(n.message||"Failed to send message");t?(t.style.display="block",t.textContent="Thank you for contacting us. We will get back to you soon!"):y("Thank you for contacting us. We will get back to you soon!"),e.target.reset(),setTimeout(()=>{const e=document.getElementById("contact-modal");e&&(e.style.display="none",document.body.style.overflow="auto"),t&&(t.style.display="none")},3e3)}catch(d){let e="There was an error sending your message. ";d.message.includes("fetch")||d.message.includes("NetworkError")?e+="Please check your internet connection and try again.":d.message.includes("validation")||d.message.includes("required")?e="Please fill in all required fields correctly.":e+=d.message||"Please try again later.",g(e)}finally{a.innerHTML=i,a.disabled=!1}}})}function ye(){return __async(this,null,function*(){const e=localStorage.getItem("token");if(e)try{const t=yield $.ajax({url:"/api/profile",method:"GET",headers:{Authorization:"Bearer "+e}});t.success&&function(e){let t=$("#navbarAvatar");t.show().empty(),e.hasProfilePhoto?t.html(`\n            <img src="/api/profile/photo/${e._id}" \n                 alt="${e.name||e.username}" \n                 onerror="this.style.display='none'; this.parentElement.textContent='${e.initials}';">\n        `):t.text(e.initials);t.css("cursor","pointer").off("click").on("click",function(){window.location.href="/profile"})}(t.profile)}catch(t){$("#navbarAvatar").hide()}else $("#navbarAvatar").hide()})}$(document).ready(function(){ye()}),$(window).on("focus",function(){ye()});class ge{constructor(){this.countries=[],this.currentStates=[],this.currentCities=[],this.selectedCountry=null,this.selectedState=null,this.selectedCity=null,this.currentSelectedIndex=-1,this.activeDropdown=null,this.filteredCountries=[],this.filteredStates=[],this.filteredCities=[],this.initAutocomplete()}getFilteredCountries(){return this.filteredCountries}getFilteredStates(){return this.filteredStates}getFilteredCities(){return this.filteredCities}handleCountryInput(e){const t=document.getElementById("countryDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredCountries=[]);this.filteredCountries=this.countries.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayCountryResults(this.filteredCountries,t)}handleStateInput(e){const t=document.getElementById("stateDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredStates=[]);this.filteredStates=this.currentStates.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayStateResults(this.filteredStates,t)}handleCityInput(e){const t=document.getElementById("cityDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredCities=[]);this.filteredCities=this.currentCities.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayCityResults(this.filteredCities,t)}loadCountries(){return __async(this,null,function*(){try{const e=yield fetch("/data/countries_states_cities.json");if(!e.ok)throw new Error("Failed to load countries data");const t=yield e.json();this.countries=t.map(e=>({name:e.name,code:e.iso2,iso3:e.iso3,flag:e.emoji||"🌍",phonecode:e.phonecode,currency:e.currency,region:e.region,states:e.states||[]}))}catch(e){}})}initAutocomplete(){const e=document.getElementById("country"),t=document.getElementById("countryDropdown");e&&(e.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.handleCountryInput(e.target.value)}),e.addEventListener("focus",()=>{this.activeDropdown="country",e.value&&this.handleCountryInput(e.value)}),e.addEventListener("blur",()=>{setTimeout(()=>{"country"===this.activeDropdown&&(this.activeDropdown=null)},200)}),e.addEventListener("keydown",n=>{document.activeElement===e&&t.classList.contains("active")&&this.handleKeyboardNavigation(n,"countryDropdown")}),document.addEventListener("click",n=>{e.contains(n.target)||t.contains(n.target)||(t.classList.remove("active"),this.currentSelectedIndex=-1)}));const n=document.getElementById("state"),o=document.getElementById("stateDropdown");n&&(n.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.handleStateInput(e.target.value)}),n.addEventListener("focus",()=>{this.activeDropdown="state",n.value&&this.handleStateInput(n.value)}),n.addEventListener("blur",()=>{setTimeout(()=>{"state"===this.activeDropdown&&(this.activeDropdown=null)},200)}),n.addEventListener("keydown",e=>{document.activeElement===n&&o.classList.contains("active")&&this.handleKeyboardNavigation(e,"stateDropdown")}),document.addEventListener("click",e=>{n.contains(e.target)||o.contains(e.target)||(o.classList.remove("active"),this.currentSelectedIndex=-1)}));const a=document.getElementById("city"),i=document.getElementById("cityDropdown");a&&(a.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.currentCities.length>0&&this.handleCityInput(e.target.value)}),a.addEventListener("focus",()=>{this.activeDropdown="city",a.value&&this.currentCities.length>0&&this.handleCityInput(a.value)}),a.addEventListener("blur",()=>{setTimeout(()=>{"city"===this.activeDropdown&&(this.activeDropdown=null)},200)}),a.addEventListener("keydown",e=>{document.activeElement===a&&this.currentCities.length>0&&i.classList.contains("active")&&this.handleKeyboardNavigation(e,"cityDropdown")}),document.addEventListener("click",e=>{a.contains(e.target)||i.contains(e.target)||(i.classList.remove("active"),this.currentSelectedIndex=-1)}))}handleKeyboardNavigation(e,t){const n=document.getElementById(t);if(!n||!n.classList.contains("active"))return;const o=n.querySelectorAll(".autocomplete-item");if(0!==o.length)switch(e.key){case"ArrowDown":e.preventDefault(),e.stopPropagation(),this.currentSelectedIndex=(this.currentSelectedIndex+1)%o.length,this.updateSelection(o);break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),this.currentSelectedIndex=this.currentSelectedIndex<=0?o.length-1:this.currentSelectedIndex-1,this.updateSelection(o);break;case"Enter":e.preventDefault(),e.stopPropagation();const a=o[this.currentSelectedIndex>=0?this.currentSelectedIndex:0];a&&a._data&&("countryDropdown"===t?this.selectCountry(a._data):"stateDropdown"===t?this.selectState(a._data):"cityDropdown"===t&&this.selectCity(a._data)),n.classList.remove("active"),this.currentSelectedIndex=-1;break;case"Escape":e.preventDefault(),e.stopPropagation(),n.classList.remove("active"),this.currentSelectedIndex=-1;break;case"Tab":n.classList.remove("active"),this.currentSelectedIndex=-1}}updateSelection(e){e.forEach(e=>e.classList.remove("selected")),this.currentSelectedIndex>=0&&e[this.currentSelectedIndex]&&(e[this.currentSelectedIndex].classList.add("selected"),e[this.currentSelectedIndex].scrollIntoView({block:"nearest",behavior:"smooth"}))}handleCountryInput(e){const t=document.getElementById("countryDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.countries.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayCountryResults(n,t)}displayCountryResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No countries found</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const o=document.createElement("div");o.className="autocomplete-item",o.innerHTML=`<span class="flag">${e.flag}</span> ${e.name}`,o._data=e,o._index=n,o.addEventListener("mousedown",t=>{t.preventDefault(),this.selectCountry(e)}),t.appendChild(o)}),t.classList.add("active")}selectCountry(e){this.selectedCountry=e;const t=document.getElementById("country"),n=document.getElementById("countryCode"),o=document.getElementById("countryDropdown");t&&(t.value=e.name),n&&(n.value=e.code),o&&o.classList.remove("active"),this.selectedState=null,this.selectedCity=null,this.currentStates=[],this.currentCities=[],this.currentSelectedIndex=-1;const a=document.getElementById("state"),i=document.getElementById("stateId");a&&(a.value=""),i&&(i.value=""),this.resetCity(),this.loadStates(e)}loadStates(e){if(!e.states||0===e.states.length){this.currentStates=[];const e=document.getElementById("state");return void(e&&(e.disabled=!0,e.placeholder="No states available"))}this.currentStates=e.states.map(e=>({id:e.id,name:e.name,code:e.iso2,cities:e.cities||[]}));const t=document.getElementById("state");t&&(t.disabled=!1,t.placeholder="Start typing state name...")}handleStateInput(e){const t=document.getElementById("stateDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.currentStates.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayStateResults(n,t)}displayStateResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No states found</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const o=document.createElement("div");o.className="autocomplete-item",o.textContent=e.name,o.setAttribute("data-state-code",e.code),o.setAttribute("data-state-id",e.id),o._data=e,o._index=n,o.addEventListener("mousedown",t=>{t.preventDefault(),this.selectState(e)}),t.appendChild(o)}),t.classList.add("active")}selectState(e){this.selectedState=e;const t=document.getElementById("state"),n=document.getElementById("stateId"),o=document.getElementById("stateCode"),a=document.getElementById("stateDropdown");t&&(t.value=e.name),n&&(n.value=e.id),o&&(o.value=e.code),a&&a.classList.remove("active"),this.selectedCity=null,this.currentCities=[],this.currentSelectedIndex=-1;const i=document.getElementById("city"),s=document.getElementById("cityId");i&&(i.value=""),s&&(s.value=""),this.loadCities(e)}loadCities(e){if(!e.cities||0===e.cities.length){this.currentCities=[];const e=document.getElementById("city");return void(e&&(e.disabled=!1,e.placeholder="Type city name manually..."))}this.currentCities=e.cities.map(e=>({id:e.id,name:e.name,latitude:e.latitude,longitude:e.longitude}));const t=document.getElementById("city");t&&(t.disabled=!1,t.placeholder="Start typing city name...")}handleCityInput(e){const t=document.getElementById("cityDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.currentCities.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayCityResults(n,t)}displayCityResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No cities found - you can type manually</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const o=document.createElement("div");o.className="autocomplete-item",o.textContent=e.name,o._data=e,o._index=n,o.addEventListener("mousedown",t=>{t.preventDefault(),this.selectCity(e)}),t.appendChild(o)}),t.classList.add("active")}selectCity(e){this.selectedCity=e;const t=document.getElementById("city"),n=document.getElementById("cityId"),o=document.getElementById("cityDropdown");t&&(t.value=e.name),n&&(n.value=e.id),o&&o.classList.remove("active"),this.currentSelectedIndex=-1}resetCity(){const e=document.getElementById("city"),t=document.getElementById("cityId"),n=document.getElementById("cityDropdown");e&&(e.value="",e.disabled=!0,e.placeholder="Select state first..."),t&&(t.value=""),n&&n.classList.remove("active"),this.selectedCity=null,this.currentCities=[]}getSelectedLocation(){const e=document.getElementById("city"),t=e?e.value:null;return{country:this.selectedCountry,state:this.selectedState,city:this.selectedCity||{name:t}}}}let fe;document.addEventListener("DOMContentLoaded",()=>__async(this,null,function*(){fe=new ge,yield fe.loadCountries()}));const ve={getWallet(){return __async(this,null,function*(){try{const e=yield fetch("/api/wallet",{credentials:"include"});return yield e.json()}catch(e){return{success:!1,message:"Failed to fetch wallet"}}})},addCard(e){return __async(this,null,function*(){try{const t=yield fetch(`/api/wallet/add/${e}`,{method:"POST",credentials:"include"});return yield t.json()}catch(t){return{success:!1,message:"Failed to add card"}}})},removeCard(e){return __async(this,null,function*(){try{const t=yield fetch(`/api/wallet/remove/${e}`,{method:"DELETE",credentials:"include"});return yield t.json()}catch(t){return{success:!1,message:"Failed to remove card"}}})},checkCard(e){return __async(this,null,function*(){try{const t=yield fetch(`/api/wallet/check/${e}`,{credentials:"include"});return yield t.json()}catch(t){return{success:!1,inWallet:!1}}})}};function we(){const e=document.getElementById("walletCardsContainer");if(!e)return;const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(e){return __async(this,null,function*(){if(e.target.closest(".shareWalletCardlink")){const t=e.target.closest(".shareWalletCardlink");t.getAttribute("data-cardid");const n=t.getAttribute("data-cardname"),o=t.getAttribute("data-slug");yield ke(o,n)}if(e.target.closest(".removecardFromWallet")){const t=e.target.closest(".removecardFromWallet"),n=t.getAttribute("data-cardid"),o=t.getAttribute("data-cardname");yield Ce(n,o)}})})}function be(){return __async(this,null,function*(){const e=document.getElementById("walletCardsContainer"),t=document.getElementById("emptyWalletMessage");if(!e)return;e.innerHTML='<div style="text-align: center; padding: 2rem; color: white;"><i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i><p>Loading wallet...</p></div>';const n=yield ve.getWallet();if(!n.success||!n.wallet||0===n.wallet.cards.length)return e.innerHTML="",void(t.style.display="block");t.style.display="none",e.innerHTML=n.wallet.cards.map(e=>function(e){const t=function(e){if(!e)return"U";const t=e.trim().split(" ");if(t.length>=2)return(t[0][0]+t[t.length-1][0]).toUpperCase();return e.substring(0,2).toUpperCase()}(e.name),n=new Date(e.addedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),o=e.profileImage&&e.profileImage.url?`<img src="${e.profileImage.url}" alt="${Ee(e.name)}">`:`<span>${t}</span>`,a=e.organization||"QRMyPro",i=e.title||"";return`\n        <div class="digital-wallet-card" data-card-id="${Ee(e.slug)}">\n      \n            \n            \x3c!-- Colored Header Section --\x3e\n            <div class="wallet-card-header-section">\n                <div class="wallet-card-brand-name">${Ee(a)}</div>\n                <div class="wallet-qr-top-container">\n                    <img src="/card/${Ee(e.slug)}/qr" alt="QR Code for ${Ee(e.name)}">\n                </div>\n                \x3c!-- Overlapping Profile Photo --\x3e\n                <div class="wallet-card-avatar-overlap">\n                    ${o}\n                </div>\n            </div>\n            \n            \x3c!-- Content Section --\x3e\n            <div class="wallet-card-content">\n                <div class="wallet-card-name">${Ee(e.name)}</div>\n                ${i?`<div class="wallet-card-title">${Ee(i)}</div>`:""}\n                <div class="wallet-card-email"><a href="mailto:${Ee(e.email)}" class="wallet-display-email" title="Email">${Ee(e.email)}</a></div>\n            </div>\n            \n            \x3c!-- Contact Icons --\x3e\n            <div class="wallet-card-contacts">\n                ${e.email?`<a href="mailto:${Ee(e.email)}" class="wallet-contact-icon-btn" title="Email"><i class="fas fa-envelope"></i></a>`:""}\n                ${e.phone?`<a href="tel:${Ee(e.phone)}" class="wallet-contact-icon-btn" title="Call"><i class="fas fa-phone"></i></a>`:""}\n                ${e.phone?`<a href="sms:${Ee(e.phone)}" class="wallet-contact-icon-btn" title="Message"><i class="fas fa-sms"></i></a>`:""}\n                <a href="/card/${Ee(e.slug)}" target="_blank" class="wallet-contact-icon-btn" title="View Card"><i class="fas fa-address-card"></i></a>\n            </div>\n            \n            \x3c!-- Action Buttons - KEEPING YOUR FORMAT --\x3e\n            <div class="wallet-card-actions">\n                <a href="/card/${Ee(e.slug)}" target="_blank" class="wallet-action-btn primary">\n                    <i class="fas fa-eye"></i> View\n                </a>\n                <button class="wallet-action-btn primary shareWalletCardlink" data-cardid="${Ee(e.cardId)}" data-slug="${Ee(e.slug)}" data-cardname="${Ee(e.name)}">\n                    <i class="fas fa-share-alt"></i> Share\n                </button>\n                <button class="wallet-action-btn danger removecardFromWallet" data-cardid="${Ee(e.cardId)}" data-slug="${Ee(e.slug)}" data-cardname="${Ee(e.name)}">\n                    <i class="fas fa-trash"></i> Remove\n                </button>\n            </div>\n            \n            <div class="wallet-card-added-date">\n                Added ${n}\n            </div>\n        </div>\n    `}(e)).join(""),we()})}function Ee(e){if(!e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.toString().replace(/[&<>"']/g,e=>t[e])}function Ce(e,t){return __async(this,null,function*(){if(!confirm(`Are you sure you want to remove ${t} from your wallet?`))return;const n=yield ve.removeCard(e);if(n.success){y("Card removed from wallet");const t=document.querySelector(`[data-card-id="${e}"]`);t&&(t.style.transition="opacity 0.3s ease, transform 0.3s ease",t.style.opacity="0",t.style.transform="scale(0.9)",setTimeout(()=>{t.remove();0===document.querySelectorAll(".digital-wallet-card").length&&(document.getElementById("emptyWalletMessage").style.display="block")},300))}else g(n.message||"Failed to remove card from wallet")})}function ke(e,t){const n=`${window.location.origin}/card/${e}`;navigator.share?navigator.share({title:`${t}'s Digital Card`,text:`Check out ${t}'s digital business card`,url:n}).then(()=>{}).catch(e=>{"AbortError"===e.name||Ie(n)}):Ie(n)}function Ie(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{document.execCommand("copy"),y("Link copied to clipboard!")}catch(n){alert(`Copy this link: ${e}`)}document.body.removeChild(t)}function $e(){const e=document.querySelector(".navbar"),t=document.querySelector(".container");window.innerWidth<330?(e.style.display="none",t.style.display="none",function(){if(document.getElementById("resolution-message"))return;const e=document.createElement("div");e.id="resolution-message",e.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 9999;\n    ",e.innerHTML=`\n        <div style="background: white; padding: 2rem; border-radius: 20px; text-align: center; max-width: 90%;">\n            <div style="font-size: 3rem; margin-bottom: 1rem;">📱</div>\n            <h2 style="color: #333; margin-bottom: 1rem;">Screen Too Small</h2>\n            <p style="color: #666; line-height: 1.5;">\n                This application requires a minimum screen width of 400px.\n            </p>\n            <p style="color: #999; font-size: 0.9rem;">\n                Current width: ${window.innerWidth}px | Required: 400px minimum\n            </p>\n        </div>\n    `,document.body.appendChild(e)}()):(e.style.display="flex",t.style.display="block",function(){const e=document.getElementById("resolution-message");e&&e.remove()}())}"undefined"!=typeof window&&(window.walletAPI=ve,window.loadWalletCards=be,window.removeFromWallet=Ce,window.shareWalletCard=ke,window.handlePendingWalletCard=function(){return __async(this,null,function*(){const e=sessionStorage.getItem("pendingWalletCard"),t=sessionStorage.getItem("redirectToWallet");if(e&&t){sessionStorage.removeItem("pendingWalletCard"),sessionStorage.removeItem("redirectToWallet");const t=yield ve.addCard(e);t.success?(showPage("wallet"),y("Card added to your wallet successfully!")):g(t.message||"Failed to add card to wallet")}})},window.initializeWalletButton=function(){const e=document.getElementById("walletBtn"),t=document.getElementById("walletBtnMobile");e&&e.addEventListener("click",()=>__async(this,null,function*(){showPage("wallet"),yield be()})),t&&t.addEventListener("click",()=>__async(this,null,function*(){showPage("wallet"),yield be()}))},window.attachWalletCardListeners=we),document.addEventListener("DOMContentLoaded",function(){return __async(this,null,function*(){!function(){function e(){$("#hamburgerMenu").removeClass("active"),$("#mobileMenu").removeClass("active"),$("body").removeClass("menu-open")}$("#signupWithGoogle-btn").on("click",N),$("#singup-cta-button").on("click",()=>P("signup")),$("#singup-cta-button-uc").on("click",()=>P("signup")),$("#signupBtn").on("click",()=>P("signup")),$("#faqBtn").on("click",()=>P("faq")),$("#usecaseBtn").on("click",()=>P("usecase")),$("#homepage-signup").on("click",()=>P("signup")),$(".signupbutton").on("click",()=>P("signup")),$(".homebutton").on("click",()=>P("home")),$(".profilebutton").on("click",()=>P("home")),$("#loginBtn").on("click",()=>P("login")),$("#displayBtn").on("click",()=>P("display")),$("#profileBtn").on("click",()=>P("profile")),$("#logoutBtn").on("click",O),$("#googlesignin-button").on("click",W),$("#qr-upload-div").on("click",()=>document.getElementById("qrUpload").click()),$("#downloadVCard-btn").on("click",k),$("#shareCard-btn").on("click",p),$("#addToWallet-btn").on("click",Z),$("#downloadQRCode-btn").on("click",I),$(document).on("click","#downloadQRCode-btn-dynamic",I),$(document).on("click","#downloadVCard-btn-dynamic",k),$(document).on("click",".copy-url-btn",p),$(".save-btn").on("click",function(e){e.preventDefault(),se()?x():(w(),g("Please fix the errors before saving"))}),$("#hamburgerMenu").on("click",function(){$(this).toggleClass("active"),$("#mobileMenu").toggleClass("active"),$("body").toggleClass("menu-open")}),$(document).on("click",function(e){$(e.target).closest(".mobile-menu, .hamburger-menu").length||($("#hamburgerMenu").removeClass("active"),$("#mobileMenu").removeClass("active"),$("body").removeClass("menu-open"))}),$(".mobile-menu-btn.homebutton").on("click",function(){$(".homebutton").first().click(),e()}),$("#loginBtnMobile").on("click",()=>{$("#loginBtn").click(),e()}),$("#signupBtnMobile").on("click",()=>{$("#signupBtn").click(),e()}),$("#profileBtnMobile").on("click",()=>{$("#profileBtn").click(),e()}),$("#displayBtnMobile").on("click",()=>{$("#displayBtn").click(),e()}),$("#walletBtnMobile").on("click",()=>{$("#walletBtn").click(),e()}),$("#usecaseBtnMobile").on("click",()=>{$("#usecaseBtn").click(),e()}),$("#faqBtnMobile").on("click",()=>{$("#faqBtn").click(),e()}),$("#logoutBtnMobile").on("click",()=>{$("#logoutBtn").click(),e()})}(),me(),function(){const e=document.getElementById("suggestions-form");e&&(e.addEventListener("submit",he),e.addEventListener("input",e=>{if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName){e.target.style.borderColor="";const t=e.target.parentNode.querySelector(".form-error");t&&t.remove()}}))}(),function(){const e=document.getElementById("contact-form");e&&(e.addEventListener("submit",pe),e.addEventListener("input",e=>{"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"SELECT"!==e.target.tagName||(e.target.style.borderColor="")}));const t=document.getElementById("contact-modal"),n=null==t?void 0:t.querySelector(".close");n&&n.addEventListener("click",function(){t.style.display="none",document.body.style.overflow="auto";const e=document.getElementById("contact-success");e&&(e.style.display="none")}),t&&t.addEventListener("click",function(e){if(e.target===t){t.style.display="none",document.body.style.overflow="auto";const e=document.getElementById("contact-success");e&&(e.style.display="none")}})}(),L(),le(),$("#isPublic").on("change",function(){const e=$(this).is(":checked"),t=$(this).closest(".form-group").find(".form-text");e?(t.text("When checked, others can view your card using the link or QR code"),t.removeClass("text-danger").addClass("text-muted")):(t.text("Your card will be private - only you can access it when logged in"),t.removeClass("text-muted").addClass("text-danger"))}),yield function(){return __async(this,null,function*(){if("function"==typeof initializeWalletButton&&initializeWalletButton(),!(yield T())){try{if(yield c.checkAuthStatus())try{const e=yield c.getCurrentUser();if(e.success){R(e.user),j(),F();const t=yield c.getProfile();t.success&&t.profile?($(".profile-photo-section").show(),yield S(),m(e.user.email),$("#navbarAvatar").show(),$("#navbarAvatarDesktop").show(),P("display"),$("#footer-cta").addClass("display-none-cta-button"),$("#singup-cta-button-div-uc").addClass("display-none-cta-button"),"function"==typeof handlePendingWalletCard&&(yield handlePendingWalletCard()),q()):($(".profile-photo-section").hide(),m(e.user.email),P("profile"))}}catch(e){R(null),q()}else R(null),q(),$("#footer-cta").removeClass("display-none-cta-button"),$("#singup-cta-button-div-uc").removeClass("display-none-cta-button")}catch(e){R(null),q(),$("#footer-cta").removeClass("display-none-cta-button"),$("#singup-cta-button-div-uc").removeClass("display-none-cta-button")}j(),F();const t=new URLSearchParams(window.location.search);"success"===t.get("auth")?(y("Successfully logged in!"),setTimeout(()=>__async(this,null,function*(){"function"==typeof handlePendingWalletCard&&(yield handlePendingWalletCard());const e=yield c.getProfile();e.success&&e.profile?P("display"):P("profile")}),1e3),window.history.replaceState({},document.title,window.location.pathname)):t.get("error")&&(g("Login failed. Please try again."),q(),$("#footer-cta").removeClass("display-none-cta-button"),$("#singup-cta-button-div-uc").removeClass("display-none-cta-button"))}})}(),$e(),window.addEventListener("resize",$e),$(window).on("popstate",q),$(window).on("hashchange",q)})}),window.showPage=P,window.trackSocialClick=t=>e(()=>Promise.resolve().then(()=>B)).then(e=>e.trackSocialClick(t))}();
