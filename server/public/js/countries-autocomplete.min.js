/* Minified by Terser */
class CountryAutocomplete{constructor(e,t){this.input=document.getElementById(e),this.dropdown=document.getElementById(t),this.countries=[],this.selectedIndex=-1,this.isLoading=!0,this.init()}async init(){this.showLoading(),await this.loadCountries(),this.input.addEventListener("input",e=>this.handleInput(e)),this.input.addEventListener("keydown",e=>this.handleKeydown(e)),this.input.addEventListener("focus",e=>this.handleInput(e)),this.input.addEventListener("blur",()=>{setTimeout(()=>this.hideDropdown(),200)}),this.isLoading=!1}async loadCountries(){try{const e=await fetch("https://restcountries.com/v3.1/all");if(!e.ok)throw new Error("Failed to fetch countries");const t=await e.json();this.countries=t.map(e=>({name:e.name.common,code:e.cca2,flag:e.flag||""})).sort((e,t)=>e.name.localeCompare(t.name)),console.log(`Loaded ${this.countries.length} countries`)}catch(e){console.error("Error loading countries from API:",e),this.countries=this.getFallbackCountries()}}getFallbackCountries(){return[{name:"Afghanistan",code:"AF"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"Argentina",code:"AR"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Bangladesh",code:"BD"},{name:"Belgium",code:"BE"},{name:"Brazil",code:"BR"},{name:"Canada",code:"CA"},{name:"China",code:"CN"},{name:"Denmark",code:"DK"},{name:"Egypt",code:"EG"},{name:"France",code:"FR"},{name:"Germany",code:"DE"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Ireland",code:"IE"},{name:"Italy",code:"IT"},{name:"Japan",code:"JP"},{name:"Mexico",code:"MX"},{name:"Netherlands",code:"NL"},{name:"New Zealand",code:"NZ"},{name:"Norway",code:"NO"},{name:"Pakistan",code:"PK"},{name:"Philippines",code:"PH"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Russia",code:"RU"},{name:"Saudi Arabia",code:"SA"},{name:"Singapore",code:"SG"},{name:"South Africa",code:"ZA"},{name:"South Korea",code:"KR"},{name:"Spain",code:"ES"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Thailand",code:"TH"},{name:"Turkey",code:"TR"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"Vietnam",code:"VN"}].sort((e,t)=>e.name.localeCompare(t.name))}handleInput(e){if(this.isLoading)return void this.showLoading();const t=e.target.value.trim().toLowerCase();if(t.length<1)return void this.hideDropdown();const n=this.countries.filter(e=>e.name.toLowerCase().includes(t));this.showDropdown(n)}handleKeydown(e){const t=this.dropdown.querySelectorAll(".dropdown-item:not(.loading)");"ArrowDown"===e.key?(e.preventDefault(),this.selectedIndex=Math.min(this.selectedIndex+1,t.length-1),this.updateSelection(t)):"ArrowUp"===e.key?(e.preventDefault(),this.selectedIndex=Math.max(this.selectedIndex-1,0),this.updateSelection(t)):"Enter"===e.key&&this.selectedIndex>=0?(e.preventDefault(),t[this.selectedIndex].click()):"Escape"===e.key&&this.hideDropdown()}updateSelection(e){e.forEach((e,t)=>{e.classList.toggle("selected",t===this.selectedIndex)}),e[this.selectedIndex]&&e[this.selectedIndex].scrollIntoView({block:"nearest"})}showLoading(){this.dropdown.innerHTML='<div class="dropdown-item loading">Loading countries...</div>',this.dropdown.style.display="block"}showDropdown(e){if(this.dropdown.innerHTML="",this.selectedIndex=-1,0===e.length)return this.dropdown.innerHTML='<div class="dropdown-item no-results">No countries found</div>',void(this.dropdown.style.display="block");e.slice(0,10).forEach((e,t)=>{const n=document.createElement("div");n.className="dropdown-item";const i=e.flag?`${e.flag} `:"";n.innerHTML=`${i}<span class="country-name">${e.name}</span>`,n.addEventListener("click",()=>this.selectCountry(e.name)),this.dropdown.appendChild(n)}),this.dropdown.style.display="block"}hideDropdown(){this.dropdown.style.display="none",this.selectedIndex=-1}selectCountry(e){this.input.value=e,this.hideDropdown(),this.input.dispatchEvent(new Event("change",{bubbles:!0}))}}class LocationAutocomplete{constructor(){this.countries=[],this.currentStates=[],this.currentCities=[],this.selectedCountry=null,this.selectedState=null,this.selectedCity=null,this.currentSelectedIndex=-1,this.activeDropdown=null,this.filteredCountries=[],this.filteredStates=[],this.filteredCities=[],this.initAutocomplete()}getFilteredCountries(){return this.filteredCountries}getFilteredStates(){return this.filteredStates}getFilteredCities(){return this.filteredCities}handleCountryInput(e){const t=document.getElementById("countryDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredCountries=[]);this.filteredCountries=this.countries.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayCountryResults(this.filteredCountries,t)}handleStateInput(e){const t=document.getElementById("stateDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredStates=[]);this.filteredStates=this.currentStates.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayStateResults(this.filteredStates,t)}handleCityInput(e){const t=document.getElementById("cityDropdown");if(!e||e.length<1)return t.classList.remove("active"),void(this.filteredCities=[]);this.filteredCities=this.currentCities.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())),this.displayCityResults(this.filteredCities,t)}async loadCountries(){try{const e=await fetch("/data/countries_states_cities.json");if(!e.ok)throw new Error("Failed to load countries data");const t=await e.json();this.countries=t.map(e=>({name:e.name,code:e.iso2,iso3:e.iso3,flag:e.emoji||"🌍",phonecode:e.phonecode,currency:e.currency,region:e.region,states:e.states||[]}))}catch(e){console.error("❌ Error loading countries:",e)}}initAutocomplete(){const e=document.getElementById("country"),t=document.getElementById("countryDropdown");e&&(e.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.handleCountryInput(e.target.value)}),e.addEventListener("focus",()=>{this.activeDropdown="country",e.value&&this.handleCountryInput(e.value)}),e.addEventListener("blur",()=>{setTimeout(()=>{"country"===this.activeDropdown&&(this.activeDropdown=null)},200)}),e.addEventListener("keydown",n=>{document.activeElement===e&&t.classList.contains("active")&&this.handleKeyboardNavigation(n,"countryDropdown")}),document.addEventListener("click",n=>{e.contains(n.target)||t.contains(n.target)||(t.classList.remove("active"),this.currentSelectedIndex=-1)}));const n=document.getElementById("state"),i=document.getElementById("stateDropdown");n&&(n.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.handleStateInput(e.target.value)}),n.addEventListener("focus",()=>{this.activeDropdown="state",n.value&&this.handleStateInput(n.value)}),n.addEventListener("blur",()=>{setTimeout(()=>{"state"===this.activeDropdown&&(this.activeDropdown=null)},200)}),n.addEventListener("keydown",e=>{document.activeElement===n&&i.classList.contains("active")&&this.handleKeyboardNavigation(e,"stateDropdown")}),document.addEventListener("click",e=>{n.contains(e.target)||i.contains(e.target)||(i.classList.remove("active"),this.currentSelectedIndex=-1)}));const s=document.getElementById("city"),o=document.getElementById("cityDropdown");s&&(s.addEventListener("input",e=>{this.currentSelectedIndex=-1,this.currentCities.length>0&&this.handleCityInput(e.target.value)}),s.addEventListener("focus",()=>{this.activeDropdown="city",s.value&&this.currentCities.length>0&&this.handleCityInput(s.value)}),s.addEventListener("blur",()=>{setTimeout(()=>{"city"===this.activeDropdown&&(this.activeDropdown=null)},200)}),s.addEventListener("keydown",e=>{document.activeElement===s&&this.currentCities.length>0&&o.classList.contains("active")&&this.handleKeyboardNavigation(e,"cityDropdown")}),document.addEventListener("click",e=>{s.contains(e.target)||o.contains(e.target)||(o.classList.remove("active"),this.currentSelectedIndex=-1)}))}handleKeyboardNavigation(e,t){const n=document.getElementById(t);if(!n||!n.classList.contains("active"))return;const i=n.querySelectorAll(".autocomplete-item");if(0!==i.length)switch(e.key){case"ArrowDown":e.preventDefault(),e.stopPropagation(),this.currentSelectedIndex=(this.currentSelectedIndex+1)%i.length,this.updateSelection(i);break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),this.currentSelectedIndex=this.currentSelectedIndex<=0?i.length-1:this.currentSelectedIndex-1,this.updateSelection(i);break;case"Enter":e.preventDefault(),e.stopPropagation();const s=i[this.currentSelectedIndex>=0?this.currentSelectedIndex:0];s&&s._data&&("countryDropdown"===t?this.selectCountry(s._data):"stateDropdown"===t?this.selectState(s._data):"cityDropdown"===t&&this.selectCity(s._data)),n.classList.remove("active"),this.currentSelectedIndex=-1;break;case"Escape":e.preventDefault(),e.stopPropagation(),n.classList.remove("active"),this.currentSelectedIndex=-1;break;case"Tab":n.classList.remove("active"),this.currentSelectedIndex=-1}}updateSelection(e){e.forEach(e=>e.classList.remove("selected")),this.currentSelectedIndex>=0&&e[this.currentSelectedIndex]&&(e[this.currentSelectedIndex].classList.add("selected"),e[this.currentSelectedIndex].scrollIntoView({block:"nearest",behavior:"smooth"}))}handleCountryInput(e){const t=document.getElementById("countryDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.countries.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayCountryResults(n,t)}displayCountryResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No countries found</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const i=document.createElement("div");i.className="autocomplete-item",i.innerHTML=`<span class="flag">${e.flag}</span> ${e.name}`,i._data=e,i._index=n,i.addEventListener("mousedown",t=>{t.preventDefault(),this.selectCountry(e)}),t.appendChild(i)}),t.classList.add("active")}selectCountry(e){this.selectedCountry=e;const t=document.getElementById("country"),n=document.getElementById("countryCode"),i=document.getElementById("countryDropdown");t&&(t.value=e.name),n&&(n.value=e.code),i&&i.classList.remove("active"),this.selectedState=null,this.selectedCity=null,this.currentStates=[],this.currentCities=[],this.currentSelectedIndex=-1;const s=document.getElementById("state"),o=document.getElementById("stateId");s&&(s.value=""),o&&(o.value=""),this.resetCity(),this.loadStates(e),console.log("✅ Selected country:",e.name)}loadStates(e){if(!e.states||0===e.states.length){this.currentStates=[];const e=document.getElementById("state");return void(e&&(e.disabled=!0,e.placeholder="No states available"))}this.currentStates=e.states.map(e=>({id:e.id,name:e.name,code:e.iso2,cities:e.cities||[]}));const t=document.getElementById("state");t&&(t.disabled=!1,t.placeholder="Start typing state name...")}handleStateInput(e){const t=document.getElementById("stateDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.currentStates.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayStateResults(n,t)}displayStateResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No states found</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const i=document.createElement("div");i.className="autocomplete-item",i.textContent=e.name,i.setAttribute("data-state-code",e.code),i.setAttribute("data-state-id",e.id),i._data=e,i._index=n,i.addEventListener("mousedown",t=>{t.preventDefault(),this.selectState(e)}),t.appendChild(i)}),t.classList.add("active")}selectState(e){this.selectedState=e;const t=document.getElementById("state"),n=document.getElementById("stateId"),i=document.getElementById("stateCode"),s=document.getElementById("stateDropdown");t&&(t.value=e.name),n&&(n.value=e.id),i&&(i.value=e.code),s&&s.classList.remove("active"),this.selectedCity=null,this.currentCities=[],this.currentSelectedIndex=-1;const o=document.getElementById("city"),a=document.getElementById("cityId");o&&(o.value=""),a&&(a.value=""),this.loadCities(e),console.log("✅ Selected state:",e.name)}loadCities(e){if(!e.cities||0===e.cities.length){this.currentCities=[];const e=document.getElementById("city");return void(e&&(e.disabled=!1,e.placeholder="Type city name manually..."))}this.currentCities=e.cities.map(e=>({id:e.id,name:e.name,latitude:e.latitude,longitude:e.longitude}));const t=document.getElementById("city");t&&(t.disabled=!1,t.placeholder="Start typing city name..."),console.log(`✅ Loaded ${this.currentCities.length} cities`)}handleCityInput(e){const t=document.getElementById("cityDropdown");if(!e||e.length<1)return void t.classList.remove("active");const n=this.currentCities.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));this.displayCityResults(n,t)}displayCityResults(e,t){if(t.innerHTML="",this.currentSelectedIndex=-1,0===e.length)return t.innerHTML='<div class="autocomplete-no-results">No cities found - you can type manually</div>',void t.classList.add("active");e.slice(0,10).forEach((e,n)=>{const i=document.createElement("div");i.className="autocomplete-item",i.textContent=e.name,i._data=e,i._index=n,i.addEventListener("mousedown",t=>{t.preventDefault(),this.selectCity(e)}),t.appendChild(i)}),t.classList.add("active")}selectCity(e){this.selectedCity=e;const t=document.getElementById("city"),n=document.getElementById("cityId"),i=document.getElementById("cityDropdown");t&&(t.value=e.name),n&&(n.value=e.id),i&&i.classList.remove("active"),this.currentSelectedIndex=-1}resetCity(){const e=document.getElementById("city"),t=document.getElementById("cityId"),n=document.getElementById("cityDropdown");e&&(e.value="",e.disabled=!0,e.placeholder="Select state first..."),t&&(t.value=""),n&&n.classList.remove("active"),this.selectedCity=null,this.currentCities=[]}getSelectedLocation(){const e=document.getElementById("city"),t=e?e.value:null;return{country:this.selectedCountry,state:this.selectedState,city:this.selectedCity||{name:t}}}}let locationAutocomplete;document.addEventListener("DOMContentLoaded",async()=>{locationAutocomplete=new LocationAutocomplete,await locationAutocomplete.loadCountries()});